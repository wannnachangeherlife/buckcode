---
title: ç›¸æœºæ ‡å®š
tags: [çŸ¥è¯†ç¬”è®°, è®¡ç®—æœºè§†è§‰, ç›¸æœºæ ‡å®š, ä¸‰ç»´é‡å»º]
created: 2025-01-27
category: è®¡ç®—æœºè§†è§‰
difficulty: â­â­â­â­
---

# ğŸ“ ç›¸æœºæ ‡å®š

## ğŸ¯ æ¦‚è¿°

**ä¸€å¥è¯æ€»ç»“**: ç¡®å®šç›¸æœºå†…å¤–å‚æ•°çš„è¿‡ç¨‹,å»ºç«‹ä¸‰ç»´ä¸–ç•Œåæ ‡ä¸äºŒç»´å›¾åƒåæ ‡çš„æ˜ å°„å…³ç³»

**é€‚ç”¨åœºæ™¯**: ä¸‰ç»´é‡å»ºã€å¢å¼ºç°å®ã€æœºå™¨äººè§†è§‰ã€è‡ªåŠ¨é©¾é©¶

## ğŸ“š åŸºç¡€æ¦‚å¿µ

### å®šä¹‰

ç›¸æœºæ ‡å®šæ˜¯ç¡®å®šç›¸æœºå†…å¤–å‚æ•°çš„è¿‡ç¨‹ï¼Œæ˜¯[[ä¸‰ç»´é‡å»ºåŸºç¡€]]çš„ç¬¬ä¸€æ­¥ã€‚é€šè¿‡æ ‡å®šå¯ä»¥è·å¾—ç›¸æœºçš„ç„¦è·ã€ä¸»ç‚¹ã€ç•¸å˜ç³»æ•°ç­‰å‚æ•°,ä»è€Œå®ç°ç²¾ç¡®çš„ä¸‰ç»´æµ‹é‡ã€‚

### æ ¸å¿ƒåŸç†

åˆ©ç”¨å·²çŸ¥ä¸‰ç»´åæ ‡çš„æ ‡å®šæ¿(å¦‚æ£‹ç›˜æ ¼),é€šè¿‡æ‹æ‘„å¤šå¼ ä¸åŒè§’åº¦çš„å›¾åƒ,å»ºç«‹ä¸‰ç»´ä¸–ç•Œåæ ‡ä¸äºŒç»´å›¾åƒåæ ‡ä¹‹é—´çš„æ˜ å°„å…³ç³»,æ±‚è§£ç›¸æœºå†…å¤–å‚æ•°ã€‚

### ä¸ºä»€ä¹ˆéœ€è¦å®ƒ

- ä¸‰ç»´é‡å»ºå¿…éœ€æ­¥éª¤
- æ¶ˆé™¤é•œå¤´ç•¸å˜å½±å“
- å®ç°ç²¾ç¡®çš„ç©ºé—´æµ‹é‡
- ARåº”ç”¨çš„åŸºç¡€

## ğŸ” è¯¦ç»†è¯´æ˜

### ç»„æˆéƒ¨åˆ†

1. **é’ˆå­”ç›¸æœºæ¨¡å‹**
   - ç†æƒ³çš„å‡ ä½•æŠ•å½±æ¨¡å‹
   - å¿½ç•¥é•œå¤´åšåº¦
   - ç®€åŒ–äº†å…‰å­¦ç³»ç»Ÿ

2. **å†…å‚çŸ©é˜µ**
   - ç›¸æœºå›ºæœ‰å±æ€§
   - ä¸ç›¸æœºä½å§¿æ— å…³
   - ä¸€æ¬¡æ ‡å®šé•¿æœŸæœ‰æ•ˆ

3. **å¤–å‚çŸ©é˜µ**
   - ç›¸æœºåœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„ä½å§¿
   - éšç›¸æœºç§»åŠ¨è€Œå˜åŒ–
   - æè¿°ç›¸æœºçš„æ—‹è½¬å’Œå¹³ç§»

4. **ç•¸å˜æ¨¡å‹**
   - å¾„å‘ç•¸å˜ (æ¡¶å½¢/æ•å½¢)
   - åˆ‡å‘ç•¸å˜
   - ç•¸å˜æ ¡æ­£å…¬å¼

### å·¥ä½œæµç¨‹

```
å‡†å¤‡æ ‡å®šæ¿ â†’ æ‹æ‘„å¤šè§’åº¦å›¾åƒ â†’ è§’ç‚¹æ£€æµ‹ â†’ æ±‚è§£å†…å¤–å‚ â†’ ç•¸å˜æ ¡æ­£ â†’ ç²¾åº¦éªŒè¯
```

## ğŸ’» ä»£ç ç¤ºä¾‹

### Python å®ç° (OpenCV)

```python
import cv2
import numpy as np
import glob

# 1. å‡†å¤‡æ ‡å®šæ¿è§’ç‚¹çš„ä¸–ç•Œåæ ‡
# å‡è®¾æ£‹ç›˜æ ¼ä¸º 9x6,æ¯ä¸ªæ ¼å­è¾¹é•¿ 25mm
pattern_size = (9, 6)
square_size = 25  # mm

# ç”Ÿæˆä¸–ç•Œåæ ‡ (z=0å¹³é¢)
objp = np.zeros((pattern_size[0] * pattern_size[1], 3), np.float32)
objp[:, :2] = np.mgrid[0:pattern_size[0], 0:pattern_size[1]].T.reshape(-1, 2)
objp *= square_size

# å­˜å‚¨æ‰€æœ‰å›¾åƒçš„è§’ç‚¹
objpoints = []  # ä¸‰ç»´ç‚¹
imgpoints = []  # äºŒç»´ç‚¹

# 2. è¯»å–æ ‡å®šå›¾åƒ
images = glob.glob('calibration_images/*.jpg')

for fname in images:
    img = cv2.imread(fname)
    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
    
    # æŸ¥æ‰¾æ£‹ç›˜æ ¼è§’ç‚¹
    ret, corners = cv2.findChessboardCorners(gray, pattern_size, None)
    
    if ret:
        objpoints.append(objp)
        
        # äºšåƒç´ ç²¾åº¦ä¼˜åŒ–
        criteria = (cv2.TERM_CRITERIA_EPS + cv2.TERM_CRITERIA_MAX_ITER, 30, 0.001)
        corners_refined = cv2.cornerSubPix(gray, corners, (11,11), (-1,-1), criteria)
        imgpoints.append(corners_refined)
        
        # å¯è§†åŒ–è§’ç‚¹
        cv2.drawChessboardCorners(img, pattern_size, corners_refined, ret)
        cv2.imshow('Corners', img)
        cv2.waitKey(500)

cv2.destroyAllWindows()

# 3. ç›¸æœºæ ‡å®š
ret, K, dist, rvecs, tvecs = cv2.calibrateCamera(
    objpoints, imgpoints, gray.shape[::-1], None, None
)

print("æ ‡å®šå®Œæˆ!")
print("\nå†…å‚çŸ©é˜µ K:")
print(K)
print("\nç•¸å˜ç³»æ•° dist:")
print(dist)

# 4. è®¡ç®—é‡æŠ•å½±è¯¯å·®
total_error = 0
for i in range(len(objpoints)):
    imgpoints_proj, _ = cv2.projectPoints(objpoints[i], rvecs[i], tvecs[i], K, dist)
    error = cv2.norm(imgpoints[i], imgpoints_proj, cv2.NORM_L2) / len(imgpoints_proj)
    total_error += error

print(f"\nå¹³å‡é‡æŠ•å½±è¯¯å·®: {total_error/len(objpoints):.4f} åƒç´ ")

# 5. ç•¸å˜æ ¡æ­£ç¤ºä¾‹
img = cv2.imread('test_image.jpg')
h, w = img.shape[:2]

# è·å–ä¼˜åŒ–çš„æ–°å†…å‚çŸ©é˜µ
newcameramatrix, roi = cv2.getOptimalNewCameraMatrix(K, dist, (w,h), 1, (w,h))

# å»ç•¸å˜
dst = cv2.undistort(img, K, dist, None, newcameramatrix)

# è£å‰ªå›¾åƒ
x, y, w, h = roi
dst = dst[y:y+h, x:x+w]

cv2.imwrite('undistorted.jpg', dst)

# 6. ä¿å­˜æ ‡å®šç»“æœ
np.savez('camera_calibration.npz', 
         K=K, dist=dist, 
         newcameramatrix=newcameramatrix,
         roi=roi)
```

### å…³é”®ä»£ç è§£æ

- **findChessboardCorners**: è‡ªåŠ¨æ£€æµ‹æ£‹ç›˜æ ¼è§’ç‚¹
- **cornerSubPix**: äºšåƒç´ ç²¾åº¦ä¼˜åŒ–,æé«˜æ ‡å®šç²¾åº¦
- **calibrateCamera**: æ ¸å¿ƒæ ‡å®šå‡½æ•°,æ±‚è§£å†…å¤–å‚æ•°
- **projectPoints**: å°†ä¸‰ç»´ç‚¹æŠ•å½±åˆ°å›¾åƒå¹³é¢,ç”¨äºéªŒè¯
- **undistort**: ç•¸å˜æ ¡æ­£,ç”Ÿæˆæ— ç•¸å˜å›¾åƒ

## ğŸ“ æ•°å­¦åŸç†

### é’ˆå­”ç›¸æœºæ¨¡å‹

ä¸–ç•Œåæ ‡ $(X, Y, Z)$ åˆ°å›¾åƒåæ ‡ $(u, v)$ çš„æ˜ å°„:

$$
\begin{bmatrix}
u \\
v \\
1
\end{bmatrix}
= \frac{1}{Z}
\begin{bmatrix}
f_x & 0 & c_x \\
0 & f_y & c_y \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
R & t
\end{bmatrix}
\begin{bmatrix}
X \\
Y \\
Z \\
1
\end{bmatrix}
$$

### å†…å‚çŸ©é˜µ K

$$
K = \begin{bmatrix}
f_x & 0 & c_x \\
0 & f_y & c_y \\
0 & 0 & 1
\end{bmatrix}
$$

- $f_x, f_y$: ç„¦è· (åƒç´ å•ä½)
- $c_x, c_y$: ä¸»ç‚¹åæ ‡ (å…‰è½´ä¸å›¾åƒå¹³é¢äº¤ç‚¹)

### å¤–å‚çŸ©é˜µ [R|t]

- $R$: 3Ã—3æ—‹è½¬çŸ©é˜µ (ç›¸æœºåæ ‡ç³»åˆ°ä¸–ç•Œåæ ‡ç³»)
- $t$: 3Ã—1å¹³ç§»å‘é‡

### ç•¸å˜æ¨¡å‹

#### å¾„å‘ç•¸å˜

$$
\begin{cases}
x_{distorted} = x(1 + k_1 r^2 + k_2 r^4 + k_3 r^6) \\
y_{distorted} = y(1 + k_1 r^2 + k_2 r^4 + k_3 r^6)
\end{cases}
$$

å…¶ä¸­ $r^2 = x^2 + y^2$

#### åˆ‡å‘ç•¸å˜

$$
\begin{cases}
x_{distorted} = x + [2p_1 xy + p_2(r^2 + 2x^2)] \\
y_{distorted} = y + [p_1(r^2 + 2y^2) + 2p_2 xy]
\end{cases}
$$

## ğŸŒŸ ä¼˜ç¼ºç‚¹

### âœ… ä¼˜ç‚¹

- ä¸€æ¬¡æ ‡å®š,é•¿æœŸä½¿ç”¨
- ç²¾åº¦é«˜,å¯è¾¾äºšåƒç´ çº§
- å·¥å…·æˆç†Ÿ,æ˜“äºå®ç°
- é€‚ç”¨äºå¤§å¤šæ•°ç›¸æœº

### âŒ ç¼ºç‚¹

- éœ€è¦ä¸“é—¨çš„æ ‡å®šæ¿
- æ ‡å®šè¿‡ç¨‹è¾ƒç¹ç
- å¯¹æ ‡å®šæ¿å¹³é¢åº¦è¦æ±‚é«˜
- æç«¯ç•¸å˜ç›¸æœºæ•ˆæœä¸ä½³

## ğŸ”— ç›¸å…³æ¦‚å¿µ

- [[ä¸‰ç»´é‡å»ºåŸºç¡€]] - ç›¸æœºæ ‡å®šçš„åº”ç”¨åœºæ™¯
- [[å¯¹æå‡ ä½•]] - åŒç›®ç«‹ä½“è§†è§‰åŸºç¡€
- [[PnPé—®é¢˜]] - å·²çŸ¥3D-2Då¯¹åº”æ±‚ç›¸æœºä½å§¿
- [[Bundle Adjustment]] - å…¨å±€ä¼˜åŒ–ç›¸æœºå‚æ•°

## ğŸ“– å­¦ä¹ èµ„æº

### æ¨èé˜…è¯»

- **Multiple View Geometry** (Hartley & Zisserman) - ç¬¬6ç« 
- **Learning OpenCV 3** - ç›¸æœºæ ‡å®šç« èŠ‚

### è§†é¢‘æ•™ç¨‹

- Cyrill Stachniss - Photogrammetry è¯¾ç¨‹
- OpenCV å®˜æ–¹ç›¸æœºæ ‡å®šæ•™ç¨‹

### å®è·µå·¥å…·

- **OpenCV `calibrateCamera()`**: Python/C++å®ç°
- **MATLAB Camera Calibrator**: å›¾å½¢åŒ–ç•Œé¢
- **Kalibr** (ROS): å¤šç›¸æœºæ ‡å®šå·¥å…·
- **Camera Calibration Toolbox for Matlab**: ç»å…¸å·¥å…·ç®±

## ğŸ’¡ ä¸ªäººç†è§£

### å…³é”®è¦ç‚¹

1. **å¤šè§’åº¦å¾ˆé‡è¦**: æ ‡å®šæ¿åº”è¦†ç›–å›¾åƒå„ä¸ªåŒºåŸŸå’Œä¸åŒè§’åº¦
2. **è§’ç‚¹æ£€æµ‹æ˜¯å…³é”®**: è§’ç‚¹æ£€æµ‹å¤±è´¥ä¼šå¯¼è‡´æ ‡å®šå¤±è´¥
3. **é‡æŠ•å½±è¯¯å·®è¯„ä¼°ç²¾åº¦**: é€šå¸¸åº”å°äº1åƒç´ 

### å®¹æ˜“æ··æ·†çš„åœ°æ–¹

- **å†…å‚ vs å¤–å‚**: å†…å‚æ˜¯ç›¸æœºå›ºæœ‰çš„,å¤–å‚æè¿°ç›¸æœºä½å§¿
- **ç•¸å˜ vs æŠ•å½±**: ç•¸å˜æ˜¯é•œå¤´å¯¼è‡´çš„éçº¿æ€§å˜å½¢,æŠ•å½±æ˜¯çº¿æ€§å˜æ¢
- **ç„¦è·(mm) vs ç„¦è·(åƒç´ )**: éœ€è¦é€šè¿‡åƒå…ƒå°ºå¯¸è½¬æ¢

### è®°å¿†æŠ€å·§

- **å†…å‚**: Intrinsic,ç›¸æœºInternal(å†…éƒ¨)å±æ€§
- **å¤–å‚**: Extrinsic,ç›¸æœºExternal(å¤–éƒ¨)ä½å§¿
- **KçŸ©é˜µ**: K = Kamera (å¾·è¯­"ç›¸æœº")

## âœ… æ£€æŸ¥æ¸…å•

- [x] ç†è§£é’ˆå­”ç›¸æœºæ¨¡å‹
- [ ] ç‹¬ç«‹å®Œæˆç›¸æœºæ ‡å®š
- [ ] ç†è§£ç•¸å˜æ ¡æ­£åŸç†
- [ ] è¯„ä¼°æ ‡å®šç²¾åº¦
- [ ] åº”ç”¨åˆ°ä¸‰ç»´é‡å»ºé¡¹ç›®

## ğŸ”„ å¤ä¹ è®°å½•

| æ—¥æœŸ | è´¨é‡è¯„åˆ† | å¤‡æ³¨ |
|------|----------|------|
| 2025-01-27 | 5/5 | ç†è§£é€å½»,æ•°å­¦æ¨å¯¼æ¸…æ™° |

---
éš¾åº¦ç­‰çº§:: â­â­â­â­
æŒæ¡ç¨‹åº¦:: 85%
æœ€åå¤ä¹ :: 2025-01-27

#publish #è®¡ç®—æœºè§†è§‰ #å¤ä¹ 
